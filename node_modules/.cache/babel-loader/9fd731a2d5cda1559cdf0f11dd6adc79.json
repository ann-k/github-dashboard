{"ast":null,"code":"var _jsxFileName = \"/Users/Anna/github/github-dashboard/src/Home/Home.js\";\nimport React, { useState, useEffect } from 'react';\nimport SearchField from './SearchField.js';\nimport ResultList from './ResultList.js';\nimport Paginator from './Paginator.js';\n\nconst axios = require('axios');\n\nvar numeral = require('numeral');\n\nlet id = process.env.GITHUB_CLIENT_ID;\nconsole.log(id);\n\nfunction Home(props) {\n  const [result, setResult] = useState({\n    repos: []\n  });\n  const [preloader, setPreloader] = useState(false);\n  const [totalCount, setTotalCount] = useState(0);\n  const perPage = '10';\n  const defaultQuery = 'stars:>100';\n  const storedQuery = sessionStorage.getItem('query');\n  const [userQuery, setUserQuery] = useState(storedQuery || defaultQuery);\n  const storedCurrentPage = JSON.parse(sessionStorage.getItem('page'));\n  const [currentPage, setCurrentPage] = useState(storedCurrentPage || 1);\n\n  function handleSearch(value) {\n    setPreloader(true);\n    setUserQuery(value);\n    setResult({\n      repos: []\n    });\n    sessionStorage.setItem('query', value);\n    setCurrentPage(1);\n    sessionStorage.setItem('page', 1);\n  }\n\n  function handlePaginatorClick(pageNumber) {\n    setCurrentPage(pageNumber);\n    setResult({\n      repos: []\n    });\n    sessionStorage.setItem('page', pageNumber);\n  }\n\n  useEffect(() => {\n    setPreloader(true);\n    const query = userQuery || defaultQuery;\n    const url = `https://api.github.com/search/repositories?q=${query}&sort=stars&order=desc&per_page=${perPage}&page=${currentPage}`;\n    const headers = {\n      'Authorization': 'token 29e60afef909b3a9a1af5c6a80daee1da70ea57c'\n    };\n    let cancel;\n    axios.get(url, {\n      headers: headers,\n      cancelToken: new axios.CancelToken(c => cancel = c)\n    }).then(response => {\n      setTotalCount(response.data.total_count);\n      const items = response.data.items;\n      const repos = [];\n      items.map((item, index) => {\n        const repo = {\n          id: item.id,\n          name: item.name,\n          url: item.html_url,\n          ownerName: item.owner.login,\n          ownerPhoto: item.owner.avatar_url,\n          ownerUrl: item.owner.html_url,\n          description: item.description,\n          stars: numeral(item.stargazers_count).format('0 a')\n        };\n        repos[index] = repo;\n      });\n      setResult({\n        repos: repos\n      });\n    }).catch(e => {\n      if (axios.isCancel(e)) return;\n    }).then(() => setPreloader(false));\n    return () => cancel();\n  }, [userQuery, currentPage]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Home\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(SearchField, {\n    storedQuery: storedQuery,\n    onInputChange: handleSearch,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(ResultList, {\n    repos: result.repos,\n    preloader: preloader,\n    totalCount: totalCount,\n    userQuery: userQuery,\n    defaultQuery: defaultQuery,\n    onResultItemClick: props.onResultItemClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Paginator, {\n    currentPage: currentPage,\n    preloader: preloader,\n    totalCount: totalCount,\n    perPage: perPage,\n    userQuery: userQuery,\n    defaultQuery: defaultQuery,\n    onPaginatorClick: handlePaginatorClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  }));\n}\n\nexport default Home;","map":{"version":3,"sources":["/Users/Anna/github/github-dashboard/src/Home/Home.js"],"names":["React","useState","useEffect","SearchField","ResultList","Paginator","axios","require","numeral","id","process","env","GITHUB_CLIENT_ID","console","log","Home","props","result","setResult","repos","preloader","setPreloader","totalCount","setTotalCount","perPage","defaultQuery","storedQuery","sessionStorage","getItem","userQuery","setUserQuery","storedCurrentPage","JSON","parse","currentPage","setCurrentPage","handleSearch","value","setItem","handlePaginatorClick","pageNumber","query","url","headers","cancel","get","cancelToken","CancelToken","c","then","response","data","total_count","items","map","item","index","repo","name","html_url","ownerName","owner","login","ownerPhoto","avatar_url","ownerUrl","description","stars","stargazers_count","format","catch","e","isCancel","onResultItemClick"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,WAAP,MAAwB,kBAAxB;AACA,OAAOC,UAAP,MAAuB,iBAAvB;AACA,OAAOC,SAAP,MAAsB,gBAAtB;;AACA,MAAMC,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,IAAIC,OAAO,GAAGD,OAAO,CAAC,SAAD,CAArB;;AACA,IAAIE,EAAE,GAAGC,OAAO,CAACC,GAAR,CAAYC,gBAArB;AACAC,OAAO,CAACC,GAAR,CAAYL,EAAZ;;AAEA,SAASM,IAAT,CAAcC,KAAd,EAAqB;AACnB,QAAM,CAACC,MAAD,EAASC,SAAT,IAAsBjB,QAAQ,CAAC;AAACkB,IAAAA,KAAK,EAAE;AAAR,GAAD,CAApC;AACA,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BpB,QAAQ,CAAC,KAAD,CAA1C;AACA,QAAM,CAACqB,UAAD,EAAaC,aAAb,IAA8BtB,QAAQ,CAAC,CAAD,CAA5C;AACA,QAAMuB,OAAO,GAAG,IAAhB;AAEA,QAAMC,YAAY,GAAG,YAArB;AACA,QAAMC,WAAW,GAAGC,cAAc,CAACC,OAAf,CAAuB,OAAvB,CAApB;AACA,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4B7B,QAAQ,CAACyB,WAAW,IAAID,YAAhB,CAA1C;AAEA,QAAMM,iBAAiB,GAAGC,IAAI,CAACC,KAAL,CAAWN,cAAc,CAACC,OAAf,CAAuB,MAAvB,CAAX,CAA1B;AACA,QAAM,CAACM,WAAD,EAAcC,cAAd,IAAgClC,QAAQ,CAAC8B,iBAAiB,IAAI,CAAtB,CAA9C;;AAEA,WAASK,YAAT,CAAsBC,KAAtB,EAA6B;AAC3BhB,IAAAA,YAAY,CAAC,IAAD,CAAZ;AACAS,IAAAA,YAAY,CAACO,KAAD,CAAZ;AACAnB,IAAAA,SAAS,CAAC;AAACC,MAAAA,KAAK,EAAE;AAAR,KAAD,CAAT;AACAQ,IAAAA,cAAc,CAACW,OAAf,CAAuB,OAAvB,EAAgCD,KAAhC;AACAF,IAAAA,cAAc,CAAC,CAAD,CAAd;AACAR,IAAAA,cAAc,CAACW,OAAf,CAAuB,MAAvB,EAA+B,CAA/B;AACD;;AAED,WAASC,oBAAT,CAA8BC,UAA9B,EAA0C;AACxCL,IAAAA,cAAc,CAACK,UAAD,CAAd;AACAtB,IAAAA,SAAS,CAAC;AAACC,MAAAA,KAAK,EAAE;AAAR,KAAD,CAAT;AACAQ,IAAAA,cAAc,CAACW,OAAf,CAAuB,MAAvB,EAA+BE,UAA/B;AACD;;AAEDtC,EAAAA,SAAS,CAAC,MAAM;AACdmB,IAAAA,YAAY,CAAC,IAAD,CAAZ;AACA,UAAMoB,KAAK,GAAGZ,SAAS,IAAIJ,YAA3B;AACA,UAAMiB,GAAG,GAAI,gDAA+CD,KAAM,mCAAkCjB,OAAQ,SAAQU,WAAY,EAAhI;AACA,UAAMS,OAAO,GAAG;AAAE,uBAAkB;AAApB,KAAhB;AAEA,QAAIC,MAAJ;AACAtC,IAAAA,KAAK,CAACuC,GAAN,CAAUH,GAAV,EAAe;AACbC,MAAAA,OAAO,EAAEA,OADI;AAEbG,MAAAA,WAAW,EAAE,IAAIxC,KAAK,CAACyC,WAAV,CAAsBC,CAAC,IAAIJ,MAAM,GAAGI,CAApC;AAFA,KAAf,EAICC,IAJD,CAIMC,QAAQ,IAAI;AAChB3B,MAAAA,aAAa,CAAC2B,QAAQ,CAACC,IAAT,CAAcC,WAAf,CAAb;AACA,YAAMC,KAAK,GAAGH,QAAQ,CAACC,IAAT,CAAcE,KAA5B;AACA,YAAMlC,KAAK,GAAG,EAAd;AAEAkC,MAAAA,KAAK,CAACC,GAAN,CAAU,CAACC,IAAD,EAAOC,KAAP,KAAiB;AACzB,cAAMC,IAAI,GAAG;AACXhD,UAAAA,EAAE,EAAc8C,IAAI,CAAC9C,EADV;AAEXiD,UAAAA,IAAI,EAAYH,IAAI,CAACG,IAFV;AAGXhB,UAAAA,GAAG,EAAaa,IAAI,CAACI,QAHV;AAIXC,UAAAA,SAAS,EAAOL,IAAI,CAACM,KAAL,CAAWC,KAJhB;AAKXC,UAAAA,UAAU,EAAMR,IAAI,CAACM,KAAL,CAAWG,UALhB;AAMXC,UAAAA,QAAQ,EAAQV,IAAI,CAACM,KAAL,CAAWF,QANhB;AAOXO,UAAAA,WAAW,EAAKX,IAAI,CAACW,WAPV;AAQXC,UAAAA,KAAK,EAAW3D,OAAO,CAAC+C,IAAI,CAACa,gBAAN,CAAP,CAA+BC,MAA/B,CAAsC,KAAtC;AARL,SAAb;AAWAlD,QAAAA,KAAK,CAACqC,KAAD,CAAL,GAAeC,IAAf;AACD,OAbD;AAeAvC,MAAAA,SAAS,CAAC;AAACC,QAAAA,KAAK,EAAEA;AAAR,OAAD,CAAT;AACD,KAzBD,EA0BCmD,KA1BD,CA0BOC,CAAC,IAAI;AACV,UAAIjE,KAAK,CAACkE,QAAN,CAAeD,CAAf,CAAJ,EAAuB;AACxB,KA5BD,EA6BCtB,IA7BD,CA6BM,MAAM5B,YAAY,CAAC,KAAD,CA7BxB;AA8BA,WAAO,MAAMuB,MAAM,EAAnB;AACD,GAtCQ,EAsCN,CAACf,SAAD,EAAYK,WAAZ,CAtCM,CAAT;AAwCA,sBACE;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,WAAD;AAAa,IAAA,WAAW,EAAER,WAA1B;AACa,IAAA,aAAa,EAAEU,YAD5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,eAIE,oBAAC,UAAD;AAAY,IAAA,KAAK,EAAEnB,MAAM,CAACE,KAA1B;AACY,IAAA,SAAS,EAAEC,SADvB;AAEY,IAAA,UAAU,EAAEE,UAFxB;AAGY,IAAA,SAAS,EAAEO,SAHvB;AAIY,IAAA,YAAY,EAAEJ,YAJ1B;AAKY,IAAA,iBAAiB,EAAET,KAAK,CAACyD,iBALrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAJF,eAWE,oBAAC,SAAD;AAAW,IAAA,WAAW,EAAEvC,WAAxB;AACW,IAAA,SAAS,EAAEd,SADtB;AAEW,IAAA,UAAU,EAAEE,UAFvB;AAGW,IAAA,OAAO,EAAEE,OAHpB;AAIW,IAAA,SAAS,EAAEK,SAJtB;AAKW,IAAA,YAAY,EAAEJ,YALzB;AAMW,IAAA,gBAAgB,EAAEc,oBAN7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAXF,CADF;AAqBD;;AAED,eAAexB,IAAf","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport SearchField from './SearchField.js'\nimport ResultList from './ResultList.js'\nimport Paginator from './Paginator.js'\nconst axios = require('axios')\nvar numeral = require('numeral')\nlet id = process.env.GITHUB_CLIENT_ID\nconsole.log(id);\n\nfunction Home(props) {\n  const [result, setResult] = useState({repos: []})\n  const [preloader, setPreloader] = useState(false)\n  const [totalCount, setTotalCount] = useState(0)\n  const perPage = '10'\n\n  const defaultQuery = 'stars:>100'\n  const storedQuery = sessionStorage.getItem('query')\n  const [userQuery, setUserQuery] = useState(storedQuery || defaultQuery)\n\n  const storedCurrentPage = JSON.parse(sessionStorage.getItem('page'))\n  const [currentPage, setCurrentPage] = useState(storedCurrentPage || 1)\n\n  function handleSearch(value) {\n    setPreloader(true)\n    setUserQuery(value)\n    setResult({repos: []})\n    sessionStorage.setItem('query', value)\n    setCurrentPage(1)\n    sessionStorage.setItem('page', 1)\n  }\n\n  function handlePaginatorClick(pageNumber) {\n    setCurrentPage(pageNumber)\n    setResult({repos: []})\n    sessionStorage.setItem('page', pageNumber)\n  }\n\n  useEffect(() => {\n    setPreloader(true)\n    const query = userQuery || defaultQuery\n    const url = `https://api.github.com/search/repositories?q=${query}&sort=stars&order=desc&per_page=${perPage}&page=${currentPage}`\n    const headers = { 'Authorization' : 'token 29e60afef909b3a9a1af5c6a80daee1da70ea57c' }\n\n    let cancel\n    axios.get(url, {\n      headers: headers,\n      cancelToken: new axios.CancelToken(c => cancel = c)\n    })\n    .then(response => {\n      setTotalCount(response.data.total_count)\n      const items = response.data.items\n      const repos = []\n\n      items.map((item, index) => {\n        const repo = {\n          id:             item.id,\n          name:           item.name,\n          url:            item.html_url,\n          ownerName:      item.owner.login,\n          ownerPhoto:     item.owner.avatar_url,\n          ownerUrl:       item.owner.html_url,\n          description:    item.description,\n          stars:          numeral(item.stargazers_count).format('0 a'),\n        }\n\n        repos[index] = repo\n      })\n\n      setResult({repos: repos})\n    })\n    .catch(e => {\n      if (axios.isCancel(e)) return\n    })\n    .then(() => setPreloader(false))\n    return () => cancel()\n  }, [userQuery, currentPage])\n\n  return (\n    <div className='Home'>\n      <SearchField storedQuery={storedQuery}\n                   onInputChange={handleSearch} />\n\n      <ResultList repos={result.repos}\n                  preloader={preloader}\n                  totalCount={totalCount}\n                  userQuery={userQuery}\n                  defaultQuery={defaultQuery}\n                  onResultItemClick={props.onResultItemClick} />\n\n      <Paginator currentPage={currentPage}\n                 preloader={preloader}\n                 totalCount={totalCount}\n                 perPage={perPage}\n                 userQuery={userQuery}\n                 defaultQuery={defaultQuery}\n                 onPaginatorClick={handlePaginatorClick} />\n    </div>\n  )\n}\n\nexport default Home\n"]},"metadata":{},"sourceType":"module"}